<!DOCTYPE html>
<html lang="en" dir="ltr">
<!-- include head -->
<%- include('../partials/admin-inc/head.ejs') %>

    <body class="header-fixed sidebar-fixed sidebar-dark header-light" id="body">
        <!-- WRAPPER -->
        <div class="wrapper">
            <!-- LEFT SIDEBAR WITH OUT FOOTER -->
            <%- include('../partials/admin-inc/asidebar.ejs') %>
                <!-- PAGE WRAPPER -->
                <div class="page-wrapper">
                    <!-- Header -->
                    <%- include('../partials/admin-inc/header.ejs') %>
                        <!-- CONTENT WRAPPER -->
                        <div class="content-wrapper">
                            <div class="content">
                                <div class="container d-flex align-items-center justify-content-center">
                                    <div class="row justify-content-center">
                                        <div class="col-lg-12 col-md-10">
                                            <div class="card">
                                                <div class="card-body p-5">
                                                    <h4 class="text-dark mb-5">Edit User Details</h4>
                                                    <form id="updateuserdetail" onsubmit="return updateUserHandler()" method="post" id="updateUserDetail">
                                                        <div class="row">
                                                            <input type="hidden" name="id" id="id">

                                                            <div class="form-group col-md-12 mb-4">
                                                                <input type="text" class="form-control mb-3" id="name"
                                                                    name="name" placeholder="Full Name" required
                                                                    autocomplete="name" value="<%= user.name %>" autofocus>
                                                            </div>

                                                            <div class="form-group col-md-12 mb-4">
                                                                <input type="email" class="form-control mb-3" id="email"
                                                                    name="email" placeholder="Email Address" required
                                                                    autocomplete="email" value="<%= user.email %>" autofocus>
                                                            </div>

                                                            <div class="form-group col-md-12 ">
                                                                <select class="select form-control-lg" name="campus">
                                                                    <option value="">Select Role
                                                                    </option>
                                                                    <option value="0"<%= user.is_admin == 0 && 'selected'%> >User</option>
                                                                    <option value="1"<%= user.is_admin == 1 && 'selected'%> >Admin</option>
                                                                    <option value="2"<%= user.is_admin == 2 && 'selected'%> >Super Admin</option>
                                                                </select>
                                                            </div>

                                                            <div class="form-group col-md-12 ">
                                                                <select class="select form-control-lg" name="campus">
                                                                    <option value="">User Varifed
                                                                    </option>
                                                                    <option value="1"<%= user.is_varified== 1 && 'selected'%> >True</option>
                                                                    <option value="0"<%= user.is_varified== 0 && 'selected'%> >False</option>
                                                                </select>
                                                            </div>
                                                            <div class="col-12 d-flex justify-content-center text-danger" id="error_response_9">
                                                                <% if(typeof message !=='undefined' ){ %>
                                                                    <span class="invalid-feedback" role="alert">
                                                                        <strong>
                                                                            <%= message %>
                                                                        </strong>
                                                                    </span>
                                                                    <% } %>
                                                            </div>
                                                            <div class="col-md-12">
                                                                <button type="submit"
                                                                    class="btn btn-lg btn-primary btn-block mb-4">Update</button>
                                                            </div>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div> <!-- End Content -->
                        </div> <!-- End Content Wrapper -->
                        <!-- include Footer  -->
                        <%- include('../partials/admin-inc/footer.ejs') %>

                </div> <!-- End Page Wrapper -->
        </div> <!-- End Wrapper -->
        <script>
            function updateUserHandler() {
                event.preventDefault();
                $('#error_response_9').html('');
                let formData = $('#updateuserdetail').serializeArray();
                var formObject = {};
                for (var i = 0; i < formData.length; i++) {
                    formObject[formData[i]['name']] = formData[i]['value'];
                }
                $.ajax({
                    type: "POST",
                    data: formObject,
                    url: "/admin/updateUser/<%=user._id%>",
                    success: function (msg) {
                        if(msg.message){
                            $('#error_response_9').append(msg.message)
                        }else{
                            window.localStorage.setItem('updateuser', 1);
                            window.location.href = "/admin/admin-dashboard"
                        }
                    }
                })
                return true
            }
        </script>
    </body>

</html>