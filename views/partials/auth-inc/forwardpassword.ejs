<!-- Change Password Modal -->
<div class="modal fade" id="forgotModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-md" role="document">
        <div class="modal-content rounded-0 border-0 p-4">
            <div class="modal-header border-0">
                <h3>Password Forgot</h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="forgotPasswordEmail" onsubmit="return forgotHandler()" method="post" class="row">
                    <div class="col-12">
                        <input type="email" class="form-control mb-3" id="email" name="email"
                            placeholder="Email" required autocomplete="email" autofocus>
                    </div>
                    <div class="col-12 d-flex justify-content-center text-danger" id="error_response_2">
                        <% if(typeof message !=='undefined' ){ %>
                            <span class="invalid-feedback" role="alert">
                                <strong>
                                    <%= message %>
                                </strong>
                            </span>
                            <% } %>
                    </div>
                    <div class="col-12 d-flex justify-content-between">
                        <div class="d-inline">
                            <button type="submit" class="btn btn-primary">Send mail</button>
                        </div>
                        <div>
                            <a href="#loginModal" data-toggle="modal" class="d-inline" data-target="#loginModal"
                                onclick="$('#forgotModal').modal('hide')">Sign in instead</a>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- End Login Modal -->
<script>
    function forgotHandler() {
        event.preventDefault();
        $('#error_response_2').html('');
        let formData = $('#forgotPasswordEmail').serializeArray();
        var formObject = {};
        for (var i = 0; i < formData.length; i++) {
            formObject[formData[i]['name']] = formData[i]['value'];
        }
        $.ajax({
            type: "POST",
            data: formObject,
            url: "/auth/send-request-password-forward",
            success: function (msg) {
                if(msg.status === 'failed'){
                    $('#error_response_2').append(msg.message)
                }else{
                    window.localStorage.setItem('forgotpassword', 1);
                    window.location.href = "/"
                }
            }
        })
        return true
    }
</script>